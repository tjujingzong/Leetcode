import java.util.Arrays;

/*
 * @lc app=leetcode.cn id=1040 lang=java
 *
 * [1040] Moving Stones Until Consecutive II
 */

// @lc code=start
class Solution {
  public int[] numMovesStonesII(int[] stones) {
    Arrays.sort(stones);
    int n = stones.length;
    int mi = n;
    int mx = Math.max(stones[n - 1] - stones[1] + 1, stones[n - 2] - stones[0] + 1) - (n - 1);
    for (int i = 0, j = 0; j < n; ++j) {
      while (stones[j] - stones[i] + 1 > n) {
        ++i;
      }
      if (j - i + 1 == n - 1 && stones[j] - stones[i] == n - 2) {
        mi = Math.min(mi, 2);
      } else {
        mi = Math.min(mi, n - (j - i + 1));
      }
    }
    return new int[] { mi, mx };
  }
}
// @lc code=end
