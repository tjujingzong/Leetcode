/*
 * @lc app=leetcode.cn id=1096 lang=java
 *
 * [1096] Brace Expansion II
 */

// @lc code=start
class Solution {
  private TreeSet<String> s = new TreeSet<>();

  public List<String> braceExpansionII(String expression) {
    dfs(expression);
    return new ArrayList<>(s);
  }

  private void dfs(String exp) {
    int j = exp.indexOf('}');
    if (j == -1) {
      s.add(exp);
      return;
    }
    int i = exp.lastIndexOf('{', j);

    String a = exp.substring(0, i);
    String c = exp.substring(j + 1);
    for (String b : exp.substring(i + 1, j).split(",")) {
      dfs(a + b + c);
    }
  }
}
// @lc code=end
